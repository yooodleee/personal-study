## **형식을 나란히 유지하기**

* 일반적인 자바스크립트 코드로 구현한 함수의 형식 정보를 편집기가 적절하게 보여주었으면 한다. 하지만 1.1 절에서 본 것처럼 JSDoc으로 복잡한 객체 형식을 정의하고 싶진 않다.

* 해결: 형식 정의 파일을 '옆에 나란히' 둔 상태에서 타입스크립트 컴파일러를 '자바스크립트 확인(check JavaScript)' 모드로 실행한다.

타입스크립트는 점진적으로 적용할 수 있도록 설계되었다.
'옆에 나란히' 두는 기법을 이용해 타입스크립트 문법으로 제네릭, 조건부 형식 등을 활용해 객체 형식을 구현할 수 있으므로 복잡한 JSDoc 주석을 사용할 필요가 없다.
하지만 동시에 실제 앱은 자바스크립트로 구현할 수 있다. 프로젝트에서 적당한 위치(@types 폴더 추천)에 형식 선언 파일을 만든다.
이 파일은 .ts로 끝나는 타입스크립트 파일과 조금 다르게 .d.ts로 끝난다.
이 파일은 선언(declaration)을 저장하는 용도이며 실제 코드는 포함하지 않는다.

이 파일에 인터페이스, 형식 별칭, 복잡한 형식을 구현할 수 있다.

```
// @types/person.d.ts

// 다음과 같은 모양을 갖는 객체 인터페이스
export interface Person {
    name: string;
    age: number;
}

// 기존 인터페이스를 확장하는 인터페이스
// JSDoc 주석으로는 이를 구현하기 힘들다.
export interface Student extends Person {
    semester: number;
}
```

선언 파일에서 인터페이스를 익스포트(export) 했다는 사실을 주목하자.
익스포트한 인터페이스를 자바스크립트 파일에서 임포트(import)할 수 잇다.

```
// index.js
/**@typedef { import ("../@types/person").Person} Person */
```

첫 행의 주석은 타입스크립트가 @types/person에서 Person 형식을 임포트해 Person이라는 이름으로 사용할 수 있도록 지시한다.
마치 string 같은 기본형을 이용하듯이 이 식별자로 함수 매개변수나 객체에 주석을 추가할 수 있다.

```
// index.js, 이어서

/**
 * @param {Person} person
 */
function printPerson(person) {
    console.log(person.name);
}
```

편집기 피드백을 얻으려면 1.1 절에서 설명했듯이 자바스크립트 파일의 처음 부분에 @ts-check를 추가해야 한다.
또는 자바스크립트를 항상 검사하도록 프로젝트를 설정해야 한다.

tsconfig.json 파일을 열어 checkJs 플래그를 true로 설정한다.
이제 편집기는 src 폴더의 모든 자바스크립트 파일을 읽어 실시간으로 형식 오류 피드백을 제공한다.
명령줄에서 npx tsc를 실행해 오류를 확인할 수도 있다.

다음처럼 noEmit을 true로 설정하면 타입스크립트가 자바스크립트 파일을 예전 버전으로 변환하지 않도록 한다.

```
{
    "compileOptions": {
        "checkJs": true,
        "noEmit": true,
    }
}
```

이제 타입스크립트는 소스 파일을 읽고 필요한 형식 정보를 제공한다.
코드를 전혀 바꾸지 않고도 이 기능을 이용할 수 있다.

이 기법은 확장성이 좋다.
프리액트(Preact)(https://preactjs.org) 같은 유명한 자바스크립트 라이브러리도 이처럼 동작하며 사용자와 기여자 모두에게 훌륭한 도구를 제공한다.